# ุฏููู ุงุณุชุฎุฏุงู API ูุธุงู ุฌูุณุงุช ุงูุชุณููุน ูุงูุฃุฎุทุงุก

## ๐ ุงูููุฏูุฉ
ูุฐุง ุงูุฏููู ููุถุญ ููููุฉ ุงุณุชุฎุฏุงู API ุงูุฎุงุต ุจูุธุงู ุฌูุณุงุช ุงูุชุณููุน ูุฅุฏุงุฑุฉ ุงูุฃุฎุทุงุก ูู ูุดุฑูุน GARB.

## ๐ ูุนูููุงุช ุนุงูุฉ
- **Base URL**: `http://localhost:8000/api`
- **Content-Type**: `application/json`
- **Response Format**: JSON

---

## ๐ 1. ุฅูุดุงุก ุฌูุณุฉ ุชุณููุน ุฌุฏูุฏุฉ

### **POST** `/recitation/sessions`

### ุงูุจูุงูุงุช ุงููุทููุจุฉ:
```json
{
    "student_id": 1,
    "teacher_id": 2,
    "quran_circle_id": 1,
    "start_surah_number": 2,
    "start_verse": 1,
    "end_surah_number": 2,
    "end_verse": 5,
    "recitation_type": "ูุฑุงุฌุนุฉ ุตุบุฑู",
    "grade": 7.5,
    "evaluation": "ุฌูุฏ ุฌุฏุงู",
    "teacher_notes": "ุฌูุณุฉ ุชุฌุฑูุจูุฉ ุนุจุฑ API"
}
```

### ุงูุญููู ุงูุฅุฌุจุงุฑูุฉ:
- **student_id**: ูุนุฑู ุงูุทุงูุจ (ูุฌุจ ุฃู ูููู ููุฌูุฏ ูู ุฌุฏูู students)
- **teacher_id**: ูุนุฑู ุงููุนูู (ูุฌุจ ุฃู ูููู ููุฌูุฏ ูู ุฌุฏูู users)
- **quran_circle_id**: ูุนุฑู ุงูุญููุฉ (ูุฌุจ ุฃู ูููู ููุฌูุฏ ูู ุฌุฏูู quran_circles)
- **evaluation**: ุงูุชูููู (ุงูููู ุงูููุจููุฉ: "ููุชุงุฒ", "ุฌูุฏ ุฌุฏุงู", "ุฌูุฏ", "ููุจูู", "ุถุนูู")
- **recitation_type**: ููุน ุงูุชูุงูุฉ (ุงูููู ุงูููุจููุฉ: "ุญูุธ", "ูุฑุงุฌุนุฉ ุตุบุฑู", "ูุฑุงุฌุนุฉ ูุจุฑู", "ุชุซุจูุช")

### ุงูุญููู ุงูุงุฎุชูุงุฑูุฉ:
- **start_surah_number**: ุฑูู ุงูุณูุฑุฉ ุงูุจุฏุงูุฉ
- **start_verse**: ุฑูู ุงูุขูุฉ ุงูุจุฏุงูุฉ
- **end_surah_number**: ุฑูู ุงูุณูุฑุฉ ุงูููุงูุฉ
- **end_verse**: ุฑูู ุงูุขูุฉ ุงูููุงูุฉ
- **grade**: ุงูุฏุฑุฌุฉ (ุฑูู)
- **teacher_notes**: ููุงุญุธุงุช ุงููุนูู

### ูุซุงู ุนูู ุงูุงุณุชุฌุงุจุฉ ุงููุงุฌุญุฉ:
```json
{
    "success": true,
    "message": "ุชู ุฅูุดุงุก ุฌูุณุฉ ุงูุชุณููุน ุจูุฌุงุญ",
    "data": {
        "session_id": "RS-20250609-143022-0001",
        "student_name": "ุฃุญูุฏ ุนูู ุงูุจุงุฑูู",
        "teacher_name": "ูุณุชุฎุฏู ุงูุนุฑุถ ุงูุชูุถูุญู",
        "circle_name": "ุญููุฉ ุชุฌุฑูุจูุฉ ููุงุฎุชุจุงุฑ",
        "recitation_type": "ูุฑุงุฌุนุฉ ุตุบุฑู",
        "evaluation": "ุฌูุฏ ุฌุฏุงู",
        "grade": 7.5
    }
}
```

### ุฃุฎุทุงุก ูุญุชููุฉ (HTTP 422):
```json
{
    "message": "The given data was invalid.",
    "errors": {
        "quran_circle_id": ["The quran circle id field is required."],
        "evaluation": ["The evaluation field is required."],
        "recitation_type": ["The selected recitation type is invalid."]
    }
}
```

---

## ๐ 2. ุฌูุจ ุฌูุณุงุช ุงูุชุณููุน

### **GET** `/recitation/sessions`

### ูุนุงููุงุช ุงูุงุณุชุนูุงู (Query Parameters):
- **limit**: ุนุฏุฏ ุงูุฌูุณุงุช ุงููุทููุจ ุฌูุจูุง (ุงูุชุฑุงุถู: 5 ูู ุงูุงุฎุชุจุงุฑ)
- **student_id**: ูุนุฑู ุทุงูุจ ูุนูู ูุฌูุจ ุฌูุณุงุชู ููุท

### ูุซุงู ุนูู ุงูุทูุจ:
```
GET /api/recitation/sessions?limit=5&student_id=1
```

### ูุซุงู ุนูู ุงูุงุณุชุฌุงุจุฉ:
```json
{
    "success": true,
    "data": {
        "data": [
            {
                "session_id": "RS-20250609-143022-0001",
                "student_name": "ุฃุญูุฏ ุนูู ุงูุจุงุฑูู",
                "teacher_name": "ูุณุชุฎุฏู ุงูุนุฑุถ ุงูุชูุถูุญู",
                "circle_name": "ุญููุฉ ุชุฌุฑูุจูุฉ ููุงุฎุชุจุงุฑ",
                "recitation_type": "ูุฑุงุฌุนุฉ ุตุบุฑู",
                "evaluation": "ุฌูุฏ ุฌุฏุงู",
                "grade": 7.5,
                "session_date": "2025-06-09 14:30:22",
                "has_errors": false
            }
        ]
    }
}
```

---

## ๐ 3. ุฅุถุงูุฉ ุฃุฎุทุงุก ุงูุชูุงูุฉ

### **POST** `/recitation/errors`

### ุงูุจูุงูุงุช ุงููุทููุจุฉ:
```json
{
    "session_id": "RS-20250609-143022-0001",
    "errors": [
        {
            "surah_number": 2,
            "verse_number": 10,
            "word_text": "ูุฎุงุฏุนูู",
            "error_type": "ูุทู",
            "correction_note": "ูุทู ุงูุฎุงุก ุบูุฑ ุตุญูุญ",
            "teacher_note": "ุชุฏุฑูุจ ุนูู ุงูุญุฑูู ุงูุญูููุฉ",
            "is_repeated": false,
            "severity_level": "ูุชูุณุท"
        }
    ]
}
```

### ุงูุญููู ุงูุฅุฌุจุงุฑูุฉ:
- **session_id**: ูุนุฑู ุงูุฌูุณุฉ (ูุฌุจ ุฃู ุชููู ููุฌูุฏุฉ)
- **errors**: ูุตูููุฉ ูู ุงูุฃุฎุทุงุก

### ุญููู ูู ุฎุทุฃ:
- **surah_number**: ุฑูู ุงูุณูุฑุฉ
- **verse_number**: ุฑูู ุงูุขูุฉ
- **word_text**: ุงููุต/ุงููููุฉ ุงูุชู ุจูุง ุงูุฎุทุฃ
- **error_type**: ููุน ุงูุฎุทุฃ (ุงูููู ุงูููุจููุฉ: "ุชุฌููุฏ", "ูุทู", "ุชุฑุชูู", "ุชุดููู")
- **correction_note**: ููุงุญุธุฉ ุงูุชุตุญูุญ
- **severity_level**: ูุณุชูู ุดุฏุฉ ุงูุฎุทุฃ (ุงูููู ุงูููุจููุฉ: "ุฎููู", "ูุชูุณุท", "ุดุฏูุฏ")
- **is_repeated**: ูู ุงูุฎุทุฃ ูุชูุฑุฑ (true/false)
- **teacher_note**: ููุงุญุธุฉ ุงููุนูู (ุงุฎุชูุงุฑู)

### ูุซุงู ุนูู ุงูุงุณุชุฌุงุจุฉ ุงููุงุฌุญุฉ:
```json
{
    "success": true,
    "message": "ุชู ุฅุถุงูุฉ ุงูุฃุฎุทุงุก ุจูุฌุงุญ",
    "total_errors": 1,
    "session_updated": true
}
```

---

## ๐ 4. ุฌูุจ ุฃุฎุทุงุก ุฌูุณุฉ ูุนููุฉ

ููุงุญุธุฉ: ูุฐุง ุงูู endpoint ุบูุฑ ููุฎุชุจุฑ ูู ููู ุงูุงุฎุชุจุงุฑุ ููู ูููู ุฃู ูููู ูุชุงุญุงู.

### **GET** `/recitation/sessions/{session_id}/errors`

### ูุซุงู ุนูู ุงูุทูุจ:
```
GET /api/recitation/sessions/RS-20250609-143022-0001/errors
```

### ูุซุงู ุนูู ุงูุงุณุชุฌุงุจุฉ:
```json
{
    "success": true,
    "data": {
        "session_id": "RS-20250609-143022-0001",
        "total_errors": 4,
        "errors_by_type": {
            "ุชุฌููุฏ": 1,
            "ูุทู": 1,
            "ุชุฑุชูู": 1,
            "ุชุดููู": 1
        },
        "errors_by_severity": {
            "ูุชูุณุท": 2,
            "ุฎููู": 1,
            "ุดุฏูุฏ": 1
        },
        "repeated_errors": 2,
        "errors": [
            {
                "surah_number": 1,
                "verse_number": 2,
                "word_text": "ุงูุฑุญูู",
                "error_type": "ุชุฌููุฏ",
                "correction_note": "ุนุฏู ูุฏ ุงูุฃูู ูู ุงูุฑุญูู",
                "severity_level": "ูุชูุณุท",
                "is_repeated": true
            }
        ]
    }
}
```

---

## ๐ 5. ุฃูุซูุฉ ุนูููุฉ

### ุฅูุดุงุก ุฌูุณุฉ ุชุณููุน ุจู cURL:
```bash
curl -X POST http://localhost:8000/api/recitation/sessions \
  -H "Content-Type: application/json" \
  -d '{
    "student_id": 1,
    "teacher_id": 2,
    "quran_circle_id": 1,
    "start_surah_number": 2,
    "start_verse": 1,
    "end_surah_number": 2,
    "end_verse": 5,
    "recitation_type": "ูุฑุงุฌุนุฉ ุตุบุฑู",
    "grade": 7.5,
    "evaluation": "ุฌูุฏ ุฌุฏุงู",
    "teacher_notes": "ุฌูุณุฉ ุชุฌุฑูุจูุฉ ุนุจุฑ API"
  }'
```

### ุฅุถุงูุฉ ุฃุฎุทุงุก ุจู cURL:
```bash
curl -X POST http://localhost:8000/api/recitation/errors \
  -H "Content-Type: application/json" \
  -d '{
    "session_id": "RS-20250609-143022-0001",
    "errors": [
      {
        "surah_number": 2,
        "verse_number": 10,
        "word_text": "ูุฎุงุฏุนูู",
        "error_type": "ูุทู",
        "correction_note": "ูุทู ุงูุฎุงุก ุบูุฑ ุตุญูุญ",
        "teacher_note": "ุชุฏุฑูุจ ุนูู ุงูุญุฑูู ุงูุญูููุฉ",
        "is_repeated": false,
        "severity_level": "ูุชูุณุท"
      }
    ]
  }'
```

---

## โ๏ธ ููุงุญุธุงุช ูููุฉ

### 1. ุงูููู ุงูููุจููุฉ:

**ุฃููุงุน ุงูุชูุงูุฉ (recitation_type):**
- ุญูุธ
- ูุฑุงุฌุนุฉ ุตุบุฑู  
- ูุฑุงุฌุนุฉ ูุจุฑู
- ุชุซุจูุช

**ุงูุชููููุงุช (evaluation):**
- ููุชุงุฒ
- ุฌูุฏ ุฌุฏุงู
- ุฌูุฏ
- ููุจูู
- ุถุนูู

**ุฃููุงุน ุงูุฃุฎุทุงุก (error_type):**
- ุชุฌููุฏ
- ูุทู
- ุชุฑุชูู
- ุชุดููู

**ูุณุชููุงุช ุดุฏุฉ ุงูุฎุทุฃ (severity_level):**
- ุฎููู
- ูุชูุณุท
- ุดุฏูุฏ

### 2. ูุนุฑูุงุช ุงูุฌูุณุงุช:
- ุชุชุจุน ุงูููุท: `RS-YYYYMMDD-HHMMSS-NNNN`
- ูุซุงู: `RS-20250609-143022-0001`

### 3. ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก:
- ููุฏ 422: ุจูุงูุงุช ุบูุฑ ุตุงูุญุฉ ุฃู ูุงูุตุฉ
- ููุฏ 404: ุงูุฌูุณุฉ ุบูุฑ ููุฌูุฏุฉ
- ููุฏ 500: ุฎุทุฃ ูู ุงูุฎุงุฏู

### 4. ุฃูุถู ุงูููุงุฑุณุงุช:
- ุชุฃูุฏ ูู ูุฌูุฏ ุงูุทุงูุจ ูุงููุนูู ูุงูุญููุฉ ูุจู ุฅูุดุงุก ุงูุฌูุณุฉ
- ุงุณุชุฎุฏู ุงูููู ุงููุญุฏุฏุฉ ุจุฏูุฉ ููุญููู ุงููููุฏุฉ
- ุฃุถู ุงูุฃุฎุทุงุก ููุฑ ุญุฏูุซูุง ููุญูุงุธ ุนูู ุฏูุฉ ุงูุจูุงูุงุช
- ุงุณุชุฎุฏู ูุนุงููุงุช ุงูุชุตููุฉ ูู ุฌูุจ ุงูุฌูุณุงุช ูุชุญุณูู ุงูุฃุฏุงุก

---

## ๐งช ุงุฎุชุจุงุฑ API

ููููู ุงุณุชุฎุฏุงู ุงูุฃูุฑ ุงูุชุงูู ูุงุฎุชุจุงุฑ ุฌููุน ูุธุงุฆู API:

```bash
php artisan test:recitation-complete --api
```

ูุฐุง ุงูุฃูุฑ ุณูููู ุจู:
- ุงุฎุชุจุงุฑ ุฅูุดุงุก ุฌูุณุฉ ุฌุฏูุฏุฉ
- ุงุฎุชุจุงุฑ ุฌูุจ ุงูุฌูุณุงุช  
- ุงุฎุชุจุงุฑ ุฅุถุงูุฉ ุงูุฃุฎุทุงุก
- ุนุฑุถ ุงููุชุงุฆุฌ ูุงูุฃุฎุทุงุก ุฅู ูุฌุฏุช

---

## ๐ ุงูุฏุนู

ุฅุฐุง ูุงุฌูุช ุฃู ูุดุงููุ ููููู:
1. ุชุดุบูู ุงูุงุฎุชุจุงุฑ ุงูุดุงูู: `php artisan test:recitation-complete`
2. ูุญุต ูููุงุช ุงูุณุฌู ูู `storage/logs/`
3. ุงูุชุฃูุฏ ูู ุตุญุฉ ุงูุจูุงูุงุช ุงููุฑุณูุฉ
4. ุงูุชุญูู ูู ุญุงูุฉ ูุงุนุฏุฉ ุงูุจูุงูุงุช

---

## โ๏ธ ุชูุจูู ููู

ูุฐุง ุงูุฏููู ููุณุชุฎุฑุฌ ูุจุงุดุฑุฉ ูู ููู ุงูุงุฎุชุจุงุฑ `TestRecitationSessionsAndErrors.php` ูุงูุฐู ูุนูู ุจูุฌุงุญ. 
ุฌููุน ุงูู endpoints ูุงูุจูุงูุงุช ุงููุฐููุฑุฉ ููุง ููุฎุชุจุฑุฉ ููุคูุฏุฉ ุงูุตุญุฉ.

**ุงูู endpoints ุงููุฎุชุจุฑุฉ ูุนููุงู:**
- โ `POST /recitation/sessions` - ุฅูุดุงุก ุฌูุณุฉ
- โ `GET /recitation/sessions` - ุฌูุจ ุงูุฌูุณุงุช  
- โ `POST /recitation/errors` - ุฅุถุงูุฉ ุฃุฎุทุงุก

**ุงูู endpoints ุบูุฑ ุงููุฎุชุจุฑุฉ (ูุฏ ุชููู ูุชุงุญุฉ):**
- โ `GET /recitation/sessions/{session_id}/errors` - ุฌูุจ ุฃุฎุทุงุก ุฌูุณุฉ ูุนููุฉ
